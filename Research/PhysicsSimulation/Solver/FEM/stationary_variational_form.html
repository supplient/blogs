<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>测试用博客</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="https://gist.githubusercontent.com/supplient/1726b3acbfed278f54b66cf11129a43b/raw/62b874d98f72005d18b9b2a05d3be6815959b51b/gh-pandoc.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">测试用博客</h1>
</header>
<h1 id="变分形式">1. 变分形式</h1>
<h2 id="边值问题">1.1 边值问题</h2>
<p>欲求解<strong>边值问题</strong>(<a
href="https://en.wikipedia.org/wiki/Boundary_value_problem">Boundary
value problem</a>)：</p>
<p><span class="math display">\[
\left\{
\begin{aligned}
    \mathcal{L}(u) &amp;= 0, \quad x \in \Omega \\
    \mathcal{B_i}(u) &amp;= 0, \quad i=1,2,\dots, n_B
\end{aligned}
\right.
\]</span></p>
<p>其中<span
class="math inline">\(\mathcal{L}(u)=0\)</span>为微分方程，例如<span
class="math inline">\(\mathcal{L}(u)=f+u&#39;&#39;\)</span>；<span
class="math inline">\(\mathcal{B}_i(u)=0\)</span>为边界条件，例如<span
class="math inline">\(\mathcal{B}_i(u)=u(x_i)-g(x_i)\)</span>；<span
class="math inline">\(\Omega\)</span>为定义域；<span
class="math inline">\(u\)</span>为关于<span
class="math inline">\(x\)</span>的未知函数。</p>
<p>理想目标是找到满足边值问题的<span
class="math inline">\(u\)</span>。</p>
<h2 id="求解策略试函数法">1.2. 求解策略：试函数法</h2>
<p>我们采取的求解策略是在<strong>试空间(trial space)</strong><span
class="math inline">\(V\)</span>中找一个完全满足边界条件<span
class="math inline">\(\mathcal{B}_i(u)=0\)</span>、并尽可能满足微分方程<span
class="math inline">\(\mathcal{L}(u)=0\)</span>的近似解<span
class="math inline">\(u\in V\)</span>（被称为<strong>试函数trial
function</strong>）。</p>
<p>例如试空间可能是<span class="math inline">\(V=\{kx+b: k,b \in
R\}\)</span>， 显然，能被该空间完全满足的微分方程并不多，
例如微分方程<span
class="math inline">\(u&#39;&#39;=2\)</span>就永远不可能在<span
class="math inline">\(V=\{kx+b: k,b \in R\}\)</span>中找到解，因为<span
class="math inline">\((kx+b)&#39;&#39;\equiv 0\)</span>。</p>
<p>设边值问题的精确解为<span class="math inline">\(u_e\)</span>，
我们的期望是近似解能尽可能地接近精确解，即它俩的差在某种模下尽可能小：<span
class="math inline">\(\min_{u\in V}||u_e-u||\)</span>。</p>
<p>但我们不知道精确解<span
class="math inline">\(u_e\)</span>的解析式，所以没法直接求<span
class="math inline">\(\argmin_{u\in V}||u_e-u||\)</span>。</p>
<h2 id="céa引理变分形式与伽辽金法">1.3 Céa引理、变分形式与伽辽金法</h2>
<p><a
href="https://en.wikipedia.org/wiki/C%C3%A9a%27s_lemma"><strong>Céa引理</strong></a>（见[2]的2.8.1）指出当一些有关<span
class="math inline">\(u\)</span>和边值问题的条件被满足时，有：</p>
<p><span class="math display">\[
||u_e-u|| \leq C\min_{v\in V} ||u_e-v|| , \quad C \text{ is constant}
\]</span></p>
<p>即近似解<span class="math inline">\(u\)</span>关于<span
class="math inline">\(V\)</span>中的最优解呈线性关系。
因此我们的目标可以转为找到满足Céa引理条件的<span
class="math inline">\(u\)</span>。</p>
<p>Céa引理的条件比较复杂，我们一般也不会去验证，所以这里我们只挑选其中最重要的一条，它对我们计算近似解<span
class="math inline">\(u\)</span>有用：</p>
<p><span class="math display">\[
\begin{aligned}
R := &amp;\mathcal{L}(u) \\
(R,v) &amp;= 0 \quad \forall v \in V \\
\end{aligned}
\]</span></p>
<p>其中<span class="math inline">\((R,v) = \int_\Omega Rv
dx\)</span>为函数内积（或称为<span
class="math inline">\(L^2\)</span>内积）。</p>
<p>也就是将近似解<span class="math inline">\(u\)</span>代入微分方程<span
class="math inline">\(\mathcal{L}\)</span>后得到的 <strong>残值<span
class="math inline">\(R\)</span></strong> 要与<span
class="math inline">\(V\)</span>中的任意函数<span
class="math inline">\(v\)</span>都内积为0（即<span
class="math inline">\(R\)</span>与<span
class="math inline">\(V\)</span>正交）。</p>
<p>通常称<span class="math inline">\((R,v)=0, \forall v \in
V\)</span>为原边值问题的 <strong>变分形式(variational
formulation)</strong> ，
并称通过求解该变分形式来获取原边值问题的近似解的方法为<strong>伽辽金法(Garlekin
Method)</strong> 。</p>
<blockquote>
<p>伽辽金法是一种<strong>加权残值法(Weighted Residual Method)</strong>
。 加权残值法也是求解变分形式来获取近似解，不过它的变分形式为： <span
class="math display">\[
(R,v) = 0 \quad \forall v \in W
\]</span> 其中<span class="math inline">\(W\)</span>为有别于试空间<span
class="math inline">\(V\)</span>的另一个空间，它被称为<em>test
space</em>，而<span class="math inline">\(v\in W\)</span>被称为<em>test
function</em>。 伽辽金法就是当<span
class="math inline">\(W=V\)</span>时的加权残值法。</p>
</blockquote>
<h2 id="强形式与弱形式">1.4. 强形式与弱形式</h2>
<p>通过对<span
class="math inline">\((R,v)\)</span>应用分部积分，有时可以降低对试函数<span
class="math inline">\(u\)</span>的可导性要求。 例如当<span
class="math inline">\(\mathcal{L}(u)=u&#39;&#39;,
\Omega=[0,1]\)</span>时：</p>
<p><span class="math display">\[
\begin{aligned}
(R, v) &amp;= \int_\Omega u&#39;&#39;vdx \\
&amp;= \int_\Omega vdu&#39; \\
&amp;= \int_\Omega u&#39;v&#39;dx + u&#39;v|^1_0 \\
\end{aligned}
\]</span></p>
<p>可以看到，原本<span
class="math inline">\((R,v)\)</span>的计算要求<span
class="math inline">\(u\)</span>有二阶导数<span
class="math inline">\(u&#39;&#39;\)</span>，但在经过一步分部积分后就只要一阶导数<span
class="math inline">\(u&#39;\)</span>了。</p>
<p>一般地，我们将<span
class="math inline">\((R,v)=0\)</span>经过分部积分后得到的形式称为<strong>弱形式(weak
formulation)</strong> ，记为：</p>
<p><span class="math display">\[
F(u;v)=0 \quad \forall v \in V
\]</span></p>
<p>而原本那个有更高可导性要求的形式则称为 <strong>强形式(strong
formulation)</strong> 。 强形式和弱形式都是变分形式，只是对试函数<span
class="math inline">\(u\)</span>的可导性要求不同而已。</p>
<p>特别地，实际问题中经常碰到满足双线性性质的<span
class="math inline">\(F(u;v)\)</span>，即满足如下性质的<span
class="math inline">\(F(u;v)\)</span>：</p>
<p><span class="math display">\[
\begin{aligned}
F(u+w;v) &amp;= F(u;v) + F(w;v) \\
F(u;v+w) &amp;= F(u;v) + F(u;w) \\
\end{aligned}
\]</span></p>
<p>称满足该性质的<span
class="math inline">\(F(u;v)\)</span>为双线性形式(bilinear
form)，此时弱形式更常见的记法为：</p>
<p><span class="math display">\[
a(u,v) = L(v) \quad \forall v \in V
\]</span></p>
<p>其中<span class="math inline">\(a(u,v)\)</span>为双线性形式，<span
class="math inline">\(L(v)\)</span>为线性形式，即满足<span
class="math inline">\(L(v+w)=L(v)+L(w)\)</span>。</p>
<h2 id="边界条件">1.5. 边界条件</h2>
<p>至今我们都只关注在边值问题中的微分方程部分<span
class="math inline">\(\mathcal{L}(u)=0\)</span>，
而没有讨论边界条件<span
class="math inline">\(\mathcal{B}_i(u)=0\)</span>。</p>
<p>为了简化问题，这里我们只允许两类边界条件：</p>
<ol type="1">
<li><strong>狄利克雷边界条件(Dirichlet boundary condition)</strong>
：<span
class="math inline">\(\mathcal{B}_i(u)=u(x_i)-g(x_i)\)</span>，<span
class="math inline">\(g\)</span>为某个已知函数。</li>
<li><strong>诺依曼边界条件(Neumann boundary condition)</strong> ：<span
class="math inline">\(\mathcal{B}_i(u)=u&#39;(x_i)-g(x_i)\)</span>，<span
class="math inline">\(g\)</span>为某个已知函数。</li>
</ol>
<h3 id="狄利克雷条件">1.5.1. 狄利克雷条件</h3>
<p>为了让近似解<span
class="math inline">\(u\)</span>完全满足狄利克雷边界条件，我们修改试空间，使<span
class="math inline">\(\forall v \in V: \mathcal{B}_i(v)=0\)</span>，
即让试空间<span
class="math inline">\(V\)</span>中的所有函数都满足狄利克雷边界条件，
那么近似解<span class="math inline">\(u\in
V\)</span>自然也就满足狄利克雷边界条件了。</p>
<p>不过要注意这一做法仅适用于齐次狄利克雷边界条件<span
class="math inline">\(\mathcal{B}_i(v) = v(x_i) = 0\)</span>，
而对非齐次的狄利克雷边界条件<span
class="math inline">\(\mathcal{B}_i(v)=v(x_i) = C \neq 0\)</span>
如果也使用该方法的话， 就会导致<span
class="math inline">\(V\)</span>不可能是线性空间：</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\qquad v_1, v_2 \in V \\
&amp;\Rightarrow v_1(x_i)=v_2(x_i)=C \\
&amp;\Rightarrow v_1(x_i)-v_2(x_i) = 0 \neq C \\
&amp;\Rightarrow v_1 - v_2 \notin V
\end{aligned}
\]</span></p>
<p>而<span
class="math inline">\(V\)</span>如果不是线性空间的话，也就没法在<span
class="math inline">\(V\)</span>中找到一组基<span
class="math inline">\(\{\psi_i\}\)</span>使得<span
class="math inline">\(\forall v \in V: v = \sum c_i \psi_i\)</span>。
这会给我们求解<span class="math inline">\((R,v)=0, \forall v \in
V\)</span>时带来麻烦， 因为我们没法利用<span
class="math inline">\((R,v)\)</span>的线性性质来把它转换为<span
class="math inline">\((R, \psi_i)=0\)</span>了。</p>
<p>所以非齐次的狄利克雷边界条件处理起来是需要一些技巧的。
本文将跳过这部分，请参阅[1]的1.11节和第4章。</p>
<p>【TODO：[1]中的讨论缺乏理论支撑，而[2]中的理论分析则仅对齐次狄利克雷边界条件进行，我需要再去查阅一下对非齐次狄利克雷边界条件进行的理论分析】</p>
<h3 id="诺依曼边界条件">1.5.2. 诺依曼边界条件</h3>
<p>为了让近似解<span
class="math inline">\(u\)</span>满足诺依曼边界条件<span
class="math inline">\(\mathcal{B}_i(u)=u&#39;(x_i)-g(x_i)=0\)</span>，我们需要使用弱形式。</p>
<p>还是沿用之前的例子，当<span
class="math inline">\(\mathcal{L}(u)=u&#39;&#39;,
\Omega=[0,1]\)</span>时，对<span
class="math inline">\((R,v)\)</span>应用分部积分得到：</p>
<p><span class="math display">\[
\begin{aligned}
(R, v) &amp;= \int_\Omega u&#39;v&#39;dx + u&#39;v|^1_0 \\
\end{aligned}
\]</span></p>
<p>将变分形式<span class="math inline">\((R,v)=0, \forall v \in
V\)</span>写为常见的弱形式：</p>
<p><span class="math display">\[
\begin{aligned}
    a(u,v) = L(v) \quad \forall v \in V \\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\text{where}\left\{
\begin{aligned}
    &amp; a(u,v) = \int_\Omega u&#39;v&#39; dx \\
    &amp; L(v) = u&#39;(0)v(0) - u&#39;(1)v(1) \\
\end{aligned}
\right.
\]</span></p>
<p>注意到<span class="math inline">\(L(v)\)</span>中包含<span
class="math inline">\(u&#39;(0)\)</span>和<span
class="math inline">\(u&#39;(1)\)</span>，也就是包含了所有可能的诺依曼。
假设我们有诺依曼边界条件<span class="math inline">\(u&#39;(0)=0,
u&#39;(1)=1\)</span>，则可以联立得到方程组：</p>
$$ {
<span class="math display">\[\begin{aligned}
    a(u,v) &amp;= L(v) \quad \forall v \in V \\
    u&#39;(0) &amp;= 0 \\
    u&#39;(1) &amp;= 1 \\
\end{aligned}\]</span>
<p>.</p>
<p>$$</p>
<p>该方程组的解<span
class="math inline">\(u\)</span>一定同时满足弱形式和诺依曼边界条件。</p>
<p>（别忘了，Céa引理说明<span
class="math inline">\(u\)</span>满足弱形式时它一定是试空间里最接近精确解<span
class="math inline">\(u_e\)</span>的函数）</p>
<h3 id="别名">1.5.3. 别名</h3>
<ul>
<li>狄利克雷边值条件被显式地写进了试空间的条件中，因此通常被称为<em>essential
boundary condition</em> 。</li>
<li>诺依曼边值条件在推导弱形式时被自然地联立进弱形式中，因此通常被称为<em>natural
boundary condition</em> 。</li>
</ul>
<h3 id="例子">1.6. 例子</h3>
<p>这节给出伽辽金法求解边值问题的例子。</p>
<p>【TODO】加个例子</p>
<h1 id="使用有限元构造试空间">2. 使用有限元构造试空间</h1>
<h2 id="动机">2.1. 动机</h2>
<p>使用伽辽金法求解边值问题的步骤可以概述如下：</p>
<ol type="1">
<li>构造合适的试空间<span class="math inline">\(V\)</span>，使<span
class="math inline">\(v\in V\)</span>都满足狄利克雷边界条件</li>
<li>写出变分形式<span class="math inline">\((R,v)=0, \forall v \in
V\)</span>（与其等效的弱形式<span
class="math inline">\(a(u,v)=L(v)\)</span>）</li>
<li>联立变分形式与诺依曼边界条件，得到一个方程组</li>
<li>求解该方程组得到试函数<span
class="math inline">\(u\)</span>中的待定系数，得到近似解<span
class="math inline">\(u\)</span></li>
</ol>
<p>可以看出问题的关键是构造合适的<span
class="math inline">\(V\)</span>，它能:</p>
<ul>
<li>满足狄利克雷边界条件</li>
<li>让第4步的方程组容易求解</li>
</ul>
<p>使用有限元构造的试空间<span
class="math inline">\(V\)</span>就满足这两个需求。</p>
<h2 id="试函数分段多项式">2.2. 试函数：分段多项式</h2>
<p>我们选择使用 <strong>分段多项式(Piecewise Polynomial)</strong>
来构造试函数（也就是每段都是多项式函数的分段函数），例如：</p>
<p><img src="2023-01-20-07-53-10.png" /></p>
<p>这是因为：</p>
<ul>
<li>狄利克雷边界条件只会影响到靠近边界的那一段函数</li>
<li>通过选取合适的系数，多项式函数很容易满足狄利克雷边界条件（例如对于多项式<span
class="math inline">\(x+b\)</span>，只要使<span
class="math inline">\(b=-x_i\)</span>就能在<span
class="math inline">\(x=x_i\)</span>时归0）</li>
<li>分段多项式函数构成的试空间为线性空间，因此第4步得到的变分形式方程组为线性方程组，很容易求解</li>
</ul>
<h2 id="剖分与单元">2.3. 剖分与单元</h2>
<p>首先将定义域<span class="math inline">\(\Omega\)</span>剖分，得到
<strong>剖分(subdivision)</strong> <span
class="math inline">\(\mathcal{T}\)</span>（剖分的定义见[2]的3.3.8，简单来说就是不相交的子集集合，其并集为整个<span
class="math inline">\(\Omega\)</span>）。 将剖分中的一个子集称为一个
<strong>单元(element)</strong> 。</p>
<p>设在任意单元<span class="math inline">\(K \in
\mathcal{T}\)</span>内试函数都是一个多项式函数<span
class="math inline">\(P_K\)</span>，称其为 <strong>形函数(shape
function)</strong> ，整个定义域上的分段多项式<span
class="math inline">\(P\)</span>为：</p>
<p><span class="math display">\[
P|_K = P_K
\]</span></p>
<p>即<span class="math inline">\(P\)</span>在<span
class="math inline">\(K\)</span>中等于<span
class="math inline">\(P_K\)</span>。</p>
<h2 id="多项式空间mathcalp_m与基函数">2.4. 多项式空间<span
class="math inline">\(\mathcal{P}_m\)</span>与基函数</h2>
<p>接下来我们定义单元内的多项式函数<span
class="math inline">\(P_K\)</span>。</p>
<p>为了方便，记<span
class="math inline">\(\mathcal{P}_m\)</span>为由最高次数小于等于<span
class="math inline">\(m\)</span>的多项式构成的函数空间。</p>
<p>我们的目标是在多项式函数空间<span
class="math inline">\(\mathcal{P}_m\)</span>里找到一组合适的基<span
class="math inline">\(\{\phi_i\}\)</span>：即存在常系数<span
class="math inline">\(\{c_i\}\)</span>使得<span
class="math inline">\(P_K=\sum c_i \phi_i\)</span>。</p>
<p>任何基都是合法的，例如当<span class="math inline">\(x\in
R^1\)</span>，对于函数空间<span
class="math inline">\(\mathcal{P}_1\)</span>，基<span
class="math inline">\(\{\phi_1=x,
\phi_2=1\}\)</span>是合法的，我们可以设<span class="math inline">\(P_K =
c_1x + c_2\)</span>，然后用<span
class="math inline">\(P_K\)</span>构造<span
class="math inline">\(\Omega\)</span>上的分段多项式函数<span
class="math inline">\(P\)</span>，再把<span
class="math inline">\(P\)</span>作为试函数代入变分形式<span
class="math inline">\((R,v)=0, \forall v \in
V\)</span>中进行求解，最终得到<span class="math inline">\(c_1,
c_2\)</span>。</p>
<p>我们选取的基函数为有限元基函数。</p>
<h2 id="有限元基函数拉格朗日线性三角元">2.5.
有限元基函数：拉格朗日线性三角元</h2>
<p><strong>有限元基函数</strong>
的形式化定义方法和其他常见的构造方法(e.g. Hermite Element, Argyris
Element)参见[2]的第3章和[3]的第9章，本文将只介绍
<strong>拉格朗日线性三角元(Lagrange Linear Triangular Element)</strong>
。</p>
<p>首先先解释一下“拉格朗日线性三角元”的含义：</p>
<ul>
<li>三角元：意味着单元空间<span
class="math inline">\(K\)</span>是一个二维平面上的三角形。</li>
<li>线性：意味着构造的多项式函数<span
class="math inline">\(P_K\)</span>为一次函数，即<span
class="math inline">\(P_K \in \mathcal{P}_1\)</span>。</li>
<li>拉格朗日：意味着我们只使用顶点值来构造基函数，而不使用顶点上的导数值。与之相对的是Hermite使用顶点的一阶导数，Argyris使用顶点的二阶导数。（名字来源是拉格朗日插值多项式）</li>
</ul>
<p><img src="2023-01-20-09-15-28.png" /></p>
<p>设<span class="math inline">\(K\)</span>的三个顶点分别为<span
class="math inline">\(A, B, C\)</span>，其空间坐标为<span
class="math inline">\(\mathbf{x}_1, \mathbf{x}_2,
\mathbf{x}_3\)</span>，有<span class="math inline">\(\mathbf{x}_i \in
R^2\)</span>。</p>
<p>有限元基函数<span class="math inline">\(\phi_i\)</span>应当满足：</p>
<p><span class="math display">\[
\phi_i(\mathbf{x}_j) =
\left\{
\begin{aligned}
    &amp;1 \quad \text{if } i=j \\
    &amp;0 \quad \text{if } i\neq j
\end{aligned}
\right.
\]</span></p>
<p>即有限元基函数<span class="math inline">\(\phi_i\)</span>仅在<span
class="math inline">\(\mathbf{x}_i\)</span>上取值为1，而在其他顶点上都取值为0。
该式也被记为<span
class="math inline">\(\phi_i(\mathbf{x}_j)=\delta_{ij}\)</span>，其中<span
class="math inline">\(\delta_{ij}\)</span>为
<strong>克罗内克函数(Kronecker delta)</strong> 。</p>
<p>利用有限元基函数的这一要求和<span class="math inline">\(\phi_i \in
\mathcal{P}_1\)</span>的条件，我们可以求出<span
class="math inline">\(\phi_i\)</span>——</p>
<p>以<span class="math inline">\(\phi_1\)</span>为例。 由<span
class="math inline">\(\phi_1 \in \mathcal{P}_1\)</span>可设<span
class="math inline">\(\phi_1(\mathbf{x}) = (k_1, k_2) \cdot \mathbf{x} +
k_3\)</span>， 而因为<span
class="math inline">\(\phi_1\)</span>仅在<span
class="math inline">\(\mathbf{x}_1\)</span>上取值为1，而在<span
class="math inline">\(\phi_2,
\phi_3\)</span>上都取值为0，所以可得方程组：</p>
<p><span class="math display">\[
\left\{
\begin{aligned}
    (k_1, k_2) \cdot \mathbf{x}_1 + k_3 = 1 \\
    (k_1, k_2) \cdot \mathbf{x}_2 + k_3 = 0 \\
    (k_1, k_2) \cdot \mathbf{x}_3 + k_3 = 0 \\
\end{aligned}
\right.
\]</span></p>
<p>它是一个关于<span class="math inline">\(k_1, k_2,
k_3\)</span>的线性方程组，只要<span class="math inline">\(\mathbf{x}_1,
\mathbf{x}_2,
\mathbf{x}_3\)</span>不共线就一定有唯一解或无解。解得：</p>
<p><span class="math display">\[
M := x_1y_2-x_3y_2-x_1y_3-x_2y_1+x_3y_1+x_2y_3
\]</span></p>
<p><span class="math display">\[
\left\{
\begin{aligned}
    k_1 &amp;= \frac{y_2-y_3}{M} \\
    k_2 &amp;= \frac{x_1-x_2}{M} \\
    k_3 &amp;= \frac{x_3y_3-x_3y_2+x_2y_3-x_1y_3}{M} \\
\end{aligned}
\right.
\]</span></p>
<p>其中<span class="math inline">\(x_i, y_i\)</span>为<span
class="math inline">\(\mathbf{x}_i\)</span>的分量，即<span
class="math inline">\(\mathbf{x}_i=(x_i, y_i)\)</span>。</p>
<p>同理可求得<span class="math inline">\(\phi_2, \phi_3\)</span>。</p>
<p>此处略去证明<span class="math inline">\(\{\phi_1, \phi_2,
\phi_3\}\)</span>为<span
class="math inline">\(\mathcal{P}_1\)</span>的一组基的过程。
（提示：因为二维情况下<span
class="math inline">\(dim\mathcal{P}_1=3\)</span>，所以只要证明<span
class="math inline">\(\phi_1, \phi_2,
\phi_3\)</span>线性无关即可。）</p>
<h2 id="狄利克雷边界条件">2.6. 狄利克雷边界条件</h2>
<p>下面讨论在使用有限元基函数时该怎么让试函数满足狄利克雷边界条件。</p>
<p>首先要假设所有狄利克雷边界点都在三角元的顶点上。
尽管落在其他位置的情况也可以处理，但那就超出拉格朗日线性元可以方便处理的范畴了，因此此处为了简化讨论还是假设边界点都在顶点上。</p>
<p>设在单元<span
class="math inline">\(K\)</span>中三个顶点的空间坐标分别为<span
class="math inline">\(\mathbf{x}_1, \mathbf{x}_2,
\mathbf{x}_3\)</span>，有(齐次)狄利克雷边界条件为<span
class="math inline">\(u(\mathbf{x}_1)=0\)</span>。</p>
<p>设该单元内的基函数为<span
class="math inline">\(\{\phi_i\}\)</span>，且该单元内的多项式函数<span
class="math inline">\(P_K=\sum c_i \phi_i\)</span>，则有：</p>
<p><span class="math display">\[
\begin{aligned}
    u(\mathbf{x}_1)
    = P|_K(\mathbf{x}_1)
    = P_K(\mathbf{x}_1)
    = \sum c_i \phi_i(\mathbf{x}_1)
    = c_1
\end{aligned}
\]</span></p>
<p>其中最后一步是因为<span
class="math inline">\(\phi_i(\mathbf{x}_j)=\delta_{ij}\)</span>。</p>
<p>由<span class="math inline">\(u(\mathbf{x}_1)=c_1\)</span>可知，
要让<span class="math inline">\(v\in V\)</span>满足<span
class="math inline">\(u(\mathbf{x}_1)=0\)</span>的边界条件，
就是要让<span class="math inline">\(c_1=0\)</span>。 而<span
class="math inline">\(c_1\)</span>是我们想要求解的一个未知系数。</p>
<p>所以可以不用显式地对试空间<span
class="math inline">\(V\)</span>做任何处理，只要在最后把狄利克雷边界条件<span
class="math inline">\(\mathcal{B}_i=u(\mathbf{x}_i)=c_i=0\)</span>也联立进变分形式的方程组中即可：</p>
<p><span class="math display">\[
\left\{
\begin{aligned}
&amp; a(u,v) = L(v) \quad \forall v \in V \\
&amp; c_i=0
\end{aligned}
\right.
\]</span></p>
<p>实际计算时就是用<span
class="math inline">\(c_i=0\)</span>消去线性方程组中的若干行，非常容易。</p>
<p>【TODO：在使用有限元基函数时，非齐次狄利克雷边界条件会不会也变得容易处理了？】</p>
<h2 id="连续性与误差估计">2.7. 连续性与误差估计</h2>
<p>使用拉格朗日元构造的试空间在连续性和与精确解之间的误差上有以下性质：</p>
<ol type="1">
<li>连续性（见[2]的3.3.17）：试函数<span
class="math inline">\(P\)</span>至少一阶可导，但导函数不一定连续，即<span
class="math inline">\(P \in C^0\)</span>。
<ul>
<li>连续性确保了试函数<span
class="math inline">\(u\)</span>总是一阶可导，所以在求解二阶微分方程时能代入弱形式<span
class="math inline">\(a(u,v)=L(v), \forall v \in
V\)</span>进行计算。</li>
</ul></li>
<li>误差估计（见[2]的4.4.28和5.4.8）：求解变分形式<span
class="math inline">\((R,v)=0, \forall v \in
V\)</span>后得到的近似解<span
class="math inline">\(u\)</span>与边值问题的精确解<span
class="math inline">\(u_e\)</span>之间的差值满足：
<ul>
<li><span class="math inline">\(||u_e-u||_{L^2(\Omega)} \leq C h^{m+1}
||u_e||_{H^{m+1}(\Omega)}\)</span></li>
<li>其中<span
class="math inline">\(C\)</span>为与剖分形状相关的常系数，<span
class="math inline">\(h\in
(0,1]\)</span>为单元直径关于定义域直径的比例，<span
class="math inline">\(m\)</span>为基函数的最高次数（即<span
class="math inline">\(\mathcal{P}_m\)</span>的<span
class="math inline">\(m\)</span>），<span
class="math inline">\(\Omega\)</span>为定义域，<span
class="math inline">\(H^{m+1}=W^{m+1}_2\)</span>为索博列夫空间（不知道索博列夫空间是什么也没影响）。</li>
<li>可以理解为近似解<span
class="math inline">\(u\)</span>的误差关于<span
class="math inline">\(h^{m+1}\)</span>呈线性关系：
<ul>
<li>剖分得越细，<span
class="math inline">\(h\)</span>就越小，误差也就越小</li>
<li>使用越高次的多项式作基函数，<span
class="math inline">\(h^{m+1}\)</span>就越小，误差也就越小</li>
</ul></li>
</ul></li>
</ol>
<h2 id="例子-1">2.8. 例子</h2>
<p>本节给出使用有限元基函数构造试函数，然后使用伽辽金法计算边值问题近似解的例子。</p>
<p>【TODO】加个例子</p>
</body>
</html>
