<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>测试用博客</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="https://gist.githubusercontent.com/supplient/1726b3acbfed278f54b66cf11129a43b/raw/62b874d98f72005d18b9b2a05d3be6815959b51b/gh-pandoc.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">测试用博客</h1>
</header>
<p>Think about a constrained particle system(rigid body system is just a
constrained particle system).</p>
<p>Use <span class="math inline">\(q\)</span> for the position vector of
the whole system. And the constraint is just a function: <span
class="math inline">\(C(q)=0\)</span>.</p>
<h1 id="condition-1">Condition 1</h1>
<p>Constraint <span class="math inline">\(C=0\)</span> should be kept at
all the time.</p>
<p>If we assume <span class="math inline">\(C|_{t=0}=0,
\dot{C}|_{t=0}=0\)</span>, then all we need is to make sure:</p>
<p><span class="math display">\[
\ddot{C}(t)=0, \forall t
\]</span></p>
<h1 id="condtion-2">Condtion 2</h1>
<p>Constraint force <span class="math inline">\(F_C\)</span> should not
do work.</p>
<p>Let <span class="math inline">\(\delta q\)</span> be some small delta
for <span class="math inline">\(q\)</span> which keep <span
class="math inline">\(C=0\)</span>:</p>
<p><span class="math display">\[C(q)=0 \Rightarrow C(q+\delta q) =
0\]</span></p>
<p>Then to make constraint force <span
class="math inline">\(F_C\)</span> don’t do any work under <span
class="math inline">\(\delta q\)</span>, it should be perpendicular with
<span class="math inline">\(\delta q\)</span>:</p>
<p><span class="math display">\[F_C \perp \delta q\]</span></p>
<p>For the arbitraryness of <span class="math inline">\(\delta
q\)</span>, <span class="math inline">\(F_C\)</span> must be parallel
with the normal vector of the surface <span
class="math inline">\(C(q)=0\)</span>:</p>
<p><span class="math display">\[
F_C = \nabla C^T \lambda
\]</span></p>
<p>where <span class="math inline">\(\nabla C = \frac{\partial
C}{\partial q}\)</span> is the Jacobian of <span
class="math inline">\(C\)</span> about <span
class="math inline">\(q\)</span>.</p>
<h1 id="motion-equation">Motion Equation</h1>
<p>By Newton’s second law of motion <span
class="math inline">\(F=am\)</span>, we have:</p>
<p><span class="math display">\[
F_C + F_E = Ma
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(F_C\)</span> is constraint force</li>
<li><span class="math inline">\(F_E\)</span> is external force</li>
<li><span class="math inline">\(M\)</span> is the mass matrix</li>
<li><span class="math inline">\(a\)</span> is the acceleration</li>
</ul>
<h1 id="system-to-solve">System to solve</h1>
<p>Now combine Condition 1&amp;2 and the motion equation, we have:</p>
$$ {
<span class="math display">\[\begin{aligned}

\ddot{C}(t)=0, \forall t \\
F_C = \nabla C^T \lambda \\
F_C + F_E = Ma

\end{aligned}\]</span>
<p>. $$</p>
<p>where <span class="math inline">\(F_C, \lambda, a\)</span> are
unknowns.</p>
<p>If <span class="math inline">\(q\)</span> is <span
class="math inline">\(n\)</span>-dim and <span
class="math inline">\(C\)</span> is <span
class="math inline">\(m\)</span>-dim, then:</p>
<ul>
<li>Condition 1 provides <span class="math inline">\(m\)</span>
equations</li>
<li>Condition 2 provides <span class="math inline">\(n\)</span>
equations</li>
<li>Motion Equation provides <span class="math inline">\(n\)</span>
equations</li>
<li><span class="math inline">\(F_C, \lambda, a\)</span> have <span
class="math inline">\(n+m+n\)</span> unknowns</li>
</ul>
<p>So the system has an unique solution (if exists).</p>
<h1 id="example">Example</h1>
<p><img src="example.drawio.png" /></p>
<p>Notations are shown in the above figure.</p>
<p>Let the constraint be</p>
<p><span class="math display">\[
C(t) = \begin{bmatrix}
    x_A \\
    y_A \\
    (x_B-x_A, y_B-y_A)^2-2
\end{bmatrix}
= \mathbb{0}
\]</span></p>
<p>Let the external force be</p>
<p><span class="math display">\[
F_E = \begin{bmatrix}
    0 \\
    -g \\
    0 \\
    -g
\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(g\)</span> is the gravitational
constant.</p>
<p>Let mass be</p>
<p><span class="math display">\[
M = \begin{bmatrix}
    m_A &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; m_A &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; m_B &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; m_B \\
\end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(m_A, m_B\)</span> are the mass of A
and B.</p>
<p>Put these into the system above(repeated here for convenience):</p>
$$ {
<span class="math display">\[\begin{aligned}

\ddot{C}(t)=0 \\
F_C = \nabla C^T \lambda \\
F_C + F_E = Ma

\end{aligned}\]</span>
<p>. $$</p>
<p>where let <span class="math inline">\(q_B = (x_B, y_B), q_A=(x_A,
y_A)\)</span>, we have:</p>
<p><span class="math display">\[
\ddot{C}(t) = \begin{bmatrix}
    a_A \\
    2(v_B-v_A)^2 + 2(q_B-q_A) \cdot (a_B - a_A)
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\nabla C^T = \left[\begin{matrix}1 &amp; 0 &amp; 0 &amp; 0\\0 &amp; 1
&amp; 0 &amp; 0\\2 x_{A} - 2 x_{B} &amp; 2 y_{A} - 2 y_{B} &amp; - 2
x_{A} + 2 x_{B} &amp; - 2 y_{A} + 2 y_{B}\end{matrix}\right]
\]</span></p>
<p>And if we assume</p>
<p><span class="math display">\[
\begin{aligned}
    q_A = (0, 0) \\
    q_B = (1, -1) \\
    v_A = (0, 0) \\
    v_B = (0, 0) \\
    m_A = 1 \\
    m_B = 1 \\
\end{aligned}
\]</span></p>
<p>After solving the system equations, the solution is:</p>
<p><span class="math display">\[
\begin{aligned}
    \lambda = \begin{bmatrix}
        -\frac{g}{2} \\
        \frac{3g}{2} \\
        -\frac{g}{4} \\
    \end{bmatrix} \\
    F_C = \begin{bmatrix}
        0 \\
        g \\
        -\frac{g}{2} \\
        \frac{g}{2} \\
    \end{bmatrix} \\
    a = \begin{bmatrix}
        0 \\
        0 \\
        -\frac{g}{2} \\
        -\frac{g}{2} \\
    \end{bmatrix}
\end{aligned}
\]</span></p>
<p>If we leave <span class="math inline">\(q\)</span> and <span
class="math inline">\(v\)</span> be variables, we can get the solution
for <span class="math inline">\(a\)</span> (very complex, maybe in
vector form will be better):</p>
<p>$$ a_B^x = </p>
<p>$$</p>
<p><span class="math display">\[
a_B^y =
\frac{- g x_{A}^{2} + 2 g x_{A} x_{B} - g x_{B}^{2} +
\left(v^{1}_{A}\right)^{2} y_{A} - \left(v^{1}_{A}\right)^{2} y_{B} - 2
v^{1}_{A} v^{1}_{B} y_{A} + 2 v^{1}_{A} v^{1}_{B} y_{B} +
\left(v^{2}_{A}\right)^{2} y_{A} - \left(v^{2}_{A}\right)^{2} y_{B} - 2
v^{2}_{A} v^{2}_{B} y_{A} + 2 v^{2}_{A} v^{2}_{B} y_{B} +
\left(v^{1}_{B}\right)^{2} y_{A} - \left(v^{1}_{B}\right)^{2} y_{B} +
\left(v^{2}_{B}\right)^{2} y_{A} - \left(v^{2}_{B}\right)^{2}
y_{B}}{x_{A}^{2} - 2 x_{A} x_{B} + x_{B}^{2} + y_{A}^{2} - 2 y_{A} y_{B}
+ y_{B}^{2}}
\]</span></p>
</body>
</html>
